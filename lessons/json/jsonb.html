<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>jsonb – Complete Intro to SQLite</title><meta name="description" content="Learn how to build on SQLite with this quick and complete course with Brian Holt. SQLite is a powerful database that is easy to get started with and is a great tool for building both small and large applications."/><meta name="keywords" content="SQL,SQLite,Databases,Web Development,Node.js,JavaScript,Brian Holt,Frontend Masters"/><meta name="og:description" content="Learn how to build on SQLite with this quick and complete course with Brian Holt. SQLite is a powerful database that is easy to get started with and is a great tool for building both small and large applications."/><meta name="og:title" content="jsonb – Complete Intro to SQLite"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/27123e75b7d47aaa.css" as="style"/><link rel="stylesheet" href="/_next/static/css/27123e75b7d47aaa.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-4e7214a60fad8e88.js" defer=""></script><script src="/_next/static/chunks/framework-ecc4130bc7a58a64.js" defer=""></script><script src="/_next/static/chunks/main-be89c515900796e7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a9fbd9f7480465a3.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-f133ec3e69124099.js" defer=""></script><script src="/_next/static/UVFsG-h6A31FVwYuYsLRa/_buildManifest.js" defer=""></script><script src="/_next/static/UVFsG-h6A31FVwYuYsLRa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to SQLite</a></h1><div class="navbar-info"><a href="https://frontendmasters.com/workshops/sqlite/" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>So we&#39;ve been doing everything with the JSON functions but in reality we really want to use JSONB. It&#39;s a more compact way to represent JSON and it&#39;s faster to use. It makes everything a little harder to read but otherwise is just better.</p>
<pre><code class="hljs language-sql"><span class="hljs-comment">-- notice the b in jsonb</span>
<span class="hljs-keyword">SELECT</span> jsonb(<span class="hljs-string">&#x27;{&quot;username&quot;: &quot;btholt&quot;, &quot;favorites&quot;:[&quot;Daft Punk&quot;, &quot;Radiohead&quot;]}&#x27;</span>);
<span class="hljs-comment">-- ?1?usernamegbtholt?favorites??Daft Punk?Radiohead</span>
</code></pre><p>It comes out a little hard to read but ultimately we don&#39;t want to read it until it&#39;s out of the database so I&#39;d suggest always using JSONB.</p>
<p>Given that, let&#39;s make a table, insert some stuff into it, and write some queries.</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users (email, data);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span>
  users
  (email, data)
<span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">&#x27;brian@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Daft Punk&quot;, &quot;Radiohead&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Brian&quot;, &quot;last&quot;: &quot;Holt&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;bob@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Daft Punk&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Bob&quot;, &quot;last&quot;: &quot;Smith&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;alice@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;admin&quot;: true, &quot;favorites&quot;:[&quot;The Beatles&quot;, &quot;Queen&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Alice&quot;, &quot;last&quot;: &quot;Johnson&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;charlie@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Nirvana&quot;, &quot;Pearl Jam&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Charlie&quot;, &quot;last&quot;: &quot;Brown&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;dave@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Pink Floyd&quot;, &quot;Led Zeppelin&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Dave&quot;, &quot;last&quot;: &quot;Wilson&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;eve@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Madonna&quot;, &quot;Michael Jackson&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Eve&quot;, &quot;last&quot;: &quot;Davis&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;frank@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Queen&quot;, &quot;David Bowie&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Frank&quot;, &quot;last&quot;: &quot;Miller&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;grace@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Radiohead&quot;, &quot;Led Zeppelin&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Grace&quot;, &quot;last&quot;: &quot;Lee&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;hank@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;U2&quot;, &quot;Radiohead&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Hank&quot;, &quot;last&quot;: &quot;Taylor&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;ivy@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Adele&quot;, &quot;Beyoncé&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Ivy&quot;, &quot;last&quot;: &quot;Anderson&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;jack@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Radiohead&quot;, &quot;Muse&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Jack&quot;, &quot;last&quot;: &quot;Thomas&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;kate@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Taylor Swift&quot;, &quot;Madonna&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Kate&quot;, &quot;last&quot;: &quot;Martinez&quot;}}&#x27;</span>)),
  (<span class="hljs-string">&#x27;leo@example.com&#x27;</span>, jsonb(<span class="hljs-string">&#x27;{&quot;favorites&quot;:[&quot;Nirvana&quot;, &quot;Daft Punk&quot;], &quot;name&quot;: {&quot;first&quot;: &quot;Leo&quot;, &quot;last&quot;: &quot;Garcia&quot;}}&#x27;</span>));

<span class="hljs-comment">-- it&#x27;s readable but hard to. **never** modify this directly, always let SQLite do it</span>
<span class="hljs-keyword">SELECT</span> data <span class="hljs-keyword">from</span> users;

<span class="hljs-comment">-- get nested data</span>
<span class="hljs-keyword">SELECT</span> data <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span> <span class="hljs-string">&#x27;first&#x27;</span>, data <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span> <span class="hljs-string">&#x27;last&#x27;</span> <span class="hljs-keyword">FROM</span> users;

<span class="hljs-keyword">SELECT</span> data <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span> <span class="hljs-string">&#x27;first&#x27;</span>, data <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;&gt;</span> <span class="hljs-string">&#x27;last&#x27;</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> json_array_length(data, <span class="hljs-string">&#x27;$.favorites&#x27;</span>) <span class="hljs-operator">&lt;</span> <span class="hljs-number">2</span>;
</code></pre><p>Pretty straightforward here. Getting data out of JSON is very similar to just normal fields.</p>
<p>For the second one, we are asking for all users that have less than two favorites. You can use these functions anywhere.</p>
</div><div class="lesson-links"><a href="/lessons/json/querying" class="prev">← Previous</a><a href="/lessons/json/more-advance-queries" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="32" viewBox="0 0 40 32"><defs><clipPath id="clip-twitter-social"><rect width="40" height="32"></rect></clipPath></defs><g id="twitter-social" clip-path="url(#clip-twitter-social)"><g id="Group_269" data-name="Group 269" transform="translate(-230.23 -1140.849)"><path id="Path_419" data-name="Path 419" d="M266.12,1148.861v1.035a23.092,23.092,0,0,1-1.507,8.1,24.08,24.08,0,0,1-4.475,7.381,22.175,22.175,0,0,1-7.306,5.4,24.129,24.129,0,0,1-10,2.07,23.7,23.7,0,0,1-6.667-.945,22.83,22.83,0,0,1-5.936-2.655q.959.091,1.963.09a16.518,16.518,0,0,0,5.434-.9,17.111,17.111,0,0,0,4.749-2.52,8.275,8.275,0,0,1-4.749-1.643,7.8,7.8,0,0,1-2.877-3.983,8.268,8.268,0,0,0,1.507.135,8.58,8.58,0,0,0,2.146-.27,8.16,8.16,0,0,1-5.685-4.344,8.326,8.326,0,0,1-.89-3.578v-.135a7.775,7.775,0,0,0,3.744,1.035,8.183,8.183,0,0,1-2.671-2.9,7.817,7.817,0,0,1-.982-3.848,7.948,7.948,0,0,1,1.1-4.05,23.53,23.53,0,0,0,16.895,8.46,9.221,9.221,0,0,1-.183-1.845,7.787,7.787,0,0,1,1.1-4.05,8.216,8.216,0,0,1,2.991-2.948,7.991,7.991,0,0,1,4.087-1.1,8.184,8.184,0,0,1,5.982,2.566,16.087,16.087,0,0,0,5.205-1.98,7.784,7.784,0,0,1-1.393,2.588,8.4,8.4,0,0,1-2.215,1.913,16.856,16.856,0,0,0,4.749-1.305A17.032,17.032,0,0,1,266.12,1148.861Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"title":"jsonb"},"html":"\u003cp\u003eSo we\u0026#39;ve been doing everything with the JSON functions but in reality we really want to use JSONB. It\u0026#39;s a more compact way to represent JSON and it\u0026#39;s faster to use. It makes everything a little harder to read but otherwise is just better.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-comment\"\u003e-- notice the b in jsonb\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;username\u0026quot;: \u0026quot;btholt\u0026quot;, \u0026quot;favorites\u0026quot;:[\u0026quot;Daft Punk\u0026quot;, \u0026quot;Radiohead\u0026quot;]}\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-comment\"\u003e-- ?1?usernamegbtholt?favorites??Daft Punk?Radiohead\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIt comes out a little hard to read but ultimately we don\u0026#39;t want to read it until it\u0026#39;s out of the database so I\u0026#39;d suggest always using JSONB.\u003c/p\u003e\n\u003cp\u003eGiven that, let\u0026#39;s make a table, insert some stuff into it, and write some queries.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTABLE\u003c/span\u003e users (email, data);\n\n\u003cspan class=\"hljs-keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eINTO\u003c/span\u003e\n  users\n  (email, data)\n\u003cspan class=\"hljs-keyword\"\u003eVALUES\u003c/span\u003e\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;brian@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Daft Punk\u0026quot;, \u0026quot;Radiohead\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Brian\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Holt\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;bob@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Daft Punk\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Bob\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Smith\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;alice@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;admin\u0026quot;: true, \u0026quot;favorites\u0026quot;:[\u0026quot;The Beatles\u0026quot;, \u0026quot;Queen\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Alice\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Johnson\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;charlie@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Nirvana\u0026quot;, \u0026quot;Pearl Jam\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Charlie\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Brown\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;dave@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Pink Floyd\u0026quot;, \u0026quot;Led Zeppelin\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Dave\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Wilson\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;eve@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Madonna\u0026quot;, \u0026quot;Michael Jackson\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Eve\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Davis\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;frank@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Queen\u0026quot;, \u0026quot;David Bowie\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Frank\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Miller\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;grace@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Radiohead\u0026quot;, \u0026quot;Led Zeppelin\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Grace\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Lee\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;hank@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;U2\u0026quot;, \u0026quot;Radiohead\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Hank\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Taylor\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;ivy@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Adele\u0026quot;, \u0026quot;Beyoncé\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Ivy\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Anderson\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;jack@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Radiohead\u0026quot;, \u0026quot;Muse\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Jack\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Thomas\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;kate@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Taylor Swift\u0026quot;, \u0026quot;Madonna\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Kate\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Martinez\u0026quot;}}\u0026#x27;\u003c/span\u003e)),\n  (\u003cspan class=\"hljs-string\"\u003e\u0026#x27;leo@example.com\u0026#x27;\u003c/span\u003e, jsonb(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;favorites\u0026quot;:[\u0026quot;Nirvana\u0026quot;, \u0026quot;Daft Punk\u0026quot;], \u0026quot;name\u0026quot;: {\u0026quot;first\u0026quot;: \u0026quot;Leo\u0026quot;, \u0026quot;last\u0026quot;: \u0026quot;Garcia\u0026quot;}}\u0026#x27;\u003c/span\u003e));\n\n\u003cspan class=\"hljs-comment\"\u003e-- it\u0026#x27;s readable but hard to. **never** modify this directly, always let SQLite do it\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e data \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e users;\n\n\u003cspan class=\"hljs-comment\"\u003e-- get nested data\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e data \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;name\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;first\u0026#x27;\u003c/span\u003e, data \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;name\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;last\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e users;\n\n\u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e data \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;name\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;first\u0026#x27;\u003c/span\u003e, data \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;name\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;last\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e users \u003cspan class=\"hljs-keyword\"\u003eWHERE\u003c/span\u003e json_array_length(data, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;$.favorites\u0026#x27;\u003c/span\u003e) \u003cspan class=\"hljs-operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ePretty straightforward here. Getting data out of JSON is very similar to just normal fields.\u003c/p\u003e\n\u003cp\u003eFor the second one, we are asking for all users that have less than two favorites. You can use these functions anywhere.\u003c/p\u003e\n","markdown":"\nSo we've been doing everything with the JSON functions but in reality we really want to use JSONB. It's a more compact way to represent JSON and it's faster to use. It makes everything a little harder to read but otherwise is just better.\n\n```sql\n-- notice the b in jsonb\nSELECT jsonb('{\"username\": \"btholt\", \"favorites\":[\"Daft Punk\", \"Radiohead\"]}');\n-- ?1?usernamegbtholt?favorites??Daft Punk?Radiohead\n```\n\nIt comes out a little hard to read but ultimately we don't want to read it until it's out of the database so I'd suggest always using JSONB.\n\nGiven that, let's make a table, insert some stuff into it, and write some queries.\n\n```sql\nCREATE TABLE users (email, data);\n\nINSERT INTO\n  users\n  (email, data)\nVALUES\n  ('brian@example.com', jsonb('{\"favorites\":[\"Daft Punk\", \"Radiohead\"], \"name\": {\"first\": \"Brian\", \"last\": \"Holt\"}}')),\n  ('bob@example.com', jsonb('{\"favorites\":[\"Daft Punk\"], \"name\": {\"first\": \"Bob\", \"last\": \"Smith\"}}')),\n  ('alice@example.com', jsonb('{\"admin\": true, \"favorites\":[\"The Beatles\", \"Queen\"], \"name\": {\"first\": \"Alice\", \"last\": \"Johnson\"}}')),\n  ('charlie@example.com', jsonb('{\"favorites\":[\"Nirvana\", \"Pearl Jam\"], \"name\": {\"first\": \"Charlie\", \"last\": \"Brown\"}}')),\n  ('dave@example.com', jsonb('{\"favorites\":[\"Pink Floyd\", \"Led Zeppelin\"], \"name\": {\"first\": \"Dave\", \"last\": \"Wilson\"}}')),\n  ('eve@example.com', jsonb('{\"favorites\":[\"Madonna\", \"Michael Jackson\"], \"name\": {\"first\": \"Eve\", \"last\": \"Davis\"}}')),\n  ('frank@example.com', jsonb('{\"favorites\":[\"Queen\", \"David Bowie\"], \"name\": {\"first\": \"Frank\", \"last\": \"Miller\"}}')),\n  ('grace@example.com', jsonb('{\"favorites\":[\"Radiohead\", \"Led Zeppelin\"], \"name\": {\"first\": \"Grace\", \"last\": \"Lee\"}}')),\n  ('hank@example.com', jsonb('{\"favorites\":[\"U2\", \"Radiohead\"], \"name\": {\"first\": \"Hank\", \"last\": \"Taylor\"}}')),\n  ('ivy@example.com', jsonb('{\"favorites\":[\"Adele\", \"Beyoncé\"], \"name\": {\"first\": \"Ivy\", \"last\": \"Anderson\"}}')),\n  ('jack@example.com', jsonb('{\"favorites\":[\"Radiohead\", \"Muse\"], \"name\": {\"first\": \"Jack\", \"last\": \"Thomas\"}}')),\n  ('kate@example.com', jsonb('{\"favorites\":[\"Taylor Swift\", \"Madonna\"], \"name\": {\"first\": \"Kate\", \"last\": \"Martinez\"}}')),\n  ('leo@example.com', jsonb('{\"favorites\":[\"Nirvana\", \"Daft Punk\"], \"name\": {\"first\": \"Leo\", \"last\": \"Garcia\"}}'));\n\n-- it's readable but hard to. **never** modify this directly, always let SQLite do it\nSELECT data from users;\n\n-- get nested data\nSELECT data -\u003e 'name' -\u003e\u003e 'first', data -\u003e 'name' -\u003e\u003e 'last' FROM users;\n\nSELECT data -\u003e 'name' -\u003e\u003e 'first', data -\u003e 'name' -\u003e\u003e 'last' FROM users WHERE json_array_length(data, '$.favorites') \u003c 2;\n```\n\nPretty straightforward here. Getting data out of JSON is very similar to just normal fields.\n\nFor the second one, we are asking for all users that have less than two favorites. You can use these functions anywhere.\n","slug":"jsonb","title":"jsonb","section":"JSON","icon":"file-code","filePath":"/home/runner/work/complete-intro-to-sqlite/complete-intro-to-sqlite/lessons/08-json/C-jsonb.md","nextSlug":"/lessons/json/more-advance-queries","prevSlug":"/lessons/json/querying"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"json","slug":"jsonb"},"buildId":"UVFsG-h6A31FVwYuYsLRa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>